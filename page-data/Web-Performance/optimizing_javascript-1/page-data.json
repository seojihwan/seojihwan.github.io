{"componentChunkName":"component---src-templates-blog-post-js","path":"/Web-Performance/optimizing_javascript-1/","result":{"data":{"site":{"siteMetadata":{"title":"서지환의 블로그","author":"[Ji hwan]","siteUrl":"https://seojihwan.github.io","comment":{"disqusShortName":"https-seojihwan-github-io","utterances":"seojihwan/seojihwan.github.io"},"sponsor":{"buyMeACoffeeId":"jbee"}}},"markdownRemark":{"id":"e75ca90d-fe0b-52c8-82bb-8508a03ef61b","excerpt":"Reduce JavaScript payloads with Tree shaking 리소스 처리와 압축은 관련이 없다.\n300KB의 압축된 자바스크립트는 압축을 풀고 900KB이 되고, 결국 900KB…","html":"<h3 id=\"reduce-javascript-payloads-with-tree-shaking\" style=\"position:relative;\"><a href=\"#reduce-javascript-payloads-with-tree-shaking\" aria-label=\"reduce javascript payloads with tree shaking permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reduce JavaScript payloads with Tree shaking</h3>\n<p>리소스 처리와 압축은 관련이 없다.\n300KB의 압축된 자바스크립트는 압축을 풀고 900KB이 되고, 결국 900KB의 압축이 풀린 자바스크립트에 대해 파싱, 컴파일, 실행의 과정이 필요하다.</p>\n<p>자바스크리트는 비싼 리소스이다.\n이미지는 다운받게되면 상대적으로 짧은 디코딩 시간이 필요하지만, 자바스크립트는 파싱, 컴파일, 실행의 과정을 거치기 때문에 훨씬 값비싼 리소스라고 말할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 851px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB1klEQVQoz21Sa4+bMBDk//+gfkmrVmrSy7WVTm0OkiMkhEdCwAaDsfEbbi/JVUp1I6+92rG147G9aZpI06yDIAxfdrtouw19/7nGGOoYYyEEJEopP/DDMIwi2LA11kwXeBBa264XNel3+6xEpCE9aXulNKWdkmqykzNOC43LOolTTvn0Ds+pVrehZbGhkW5fHIscP5RpgKvjwEVSJMvN4ypfZX0Wk/2u2eV9fmbnwbwp8nSftvtP7WHGsplDXx36Is/f2ioWggJ9bI+fN7N59n2ezRf5YpHPH9IHPw8b3t1kj9PkLrO9JM6NCDdVhXCNO9LJTlppp4/gGaMRqiilYA95x8D5MAyjG7XVZVdVFCGKjDO9ooiVqC/FVba1Jk8jgpMij6pTRKp9msak7bTWQHPFV4n/uP35I1iWuFofgl/R0j/9Iby5yeac0Rb1tCF1qTgeWOvcByKNts7eEd51UdoIKQWE1MZYUGutGkfwYbKjO9fFCR/LpqiakrAG+LvDzjljjBtHObDT6bAp/OyQaHhkaGj13+TpKfm9Llbb82ZdPMNd7jsrxRgDk97MH8eeESUFGHYTrLSSWg4Sxr/i7TD0tNZCc5gNqAbAp4P8P9gro69eAl4Bq+ioPEtTob8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"javascript vs jpeg\"\n        title=\"javascript vs jpeg\"\n        src=\"/static/bad817c3c4b7bab407ab4cb8de1b86e9/0fcea/javascript_vs_jpeg.png\"\n        srcset=\"/static/bad817c3c4b7bab407ab4cb8de1b86e9/5a46d/javascript_vs_jpeg.png 300w,\n/static/bad817c3c4b7bab407ab4cb8de1b86e9/0a47e/javascript_vs_jpeg.png 600w,\n/static/bad817c3c4b7bab407ab4cb8de1b86e9/0fcea/javascript_vs_jpeg.png 851w\"\n        sizes=\"(max-width: 851px) 100vw, 851px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>지속적으로 자바스크립트 엔진의 효율성을 발전시키고 있기는 하지만 결국 자바스크립트의 퍼포먼스를 끌어올리기 위해서는 코드 스플리팅이 사용된다.</p>\n<p>하지만 자바스크립트 사용량이 많은 프로그램의 문제(한 번도 사용되지 않는 코드가 포함된)를 해결하지는 않는다. 이 문제는 tree shaking으로 해결할 수 있다.</p>\n<h3 id=\"what-is-tree-shaking\" style=\"position:relative;\"><a href=\"#what-is-tree-shaking\" aria-label=\"what is tree shaking permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What is tree shaking?</h3>\n<p>tree shaking이란 죽은 코드 제거를 제거하는 것\nRollup에 의해 대중화 되었지만, webpack에서도 이미 존재하는 개념이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Import all the array utilities!</span>\n<span class=\"token keyword\">import</span> arrayUtils <span class=\"token keyword\">from</span> <span class=\"token string\">\"array-utils\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Import only some of the utilities!</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> unique<span class=\"token punctuation\">,</span> implode<span class=\"token punctuation\">,</span> explode <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"array-utils\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>위의 두 코드는 array-utils의 모든 모듈을 import하는지와 일부만 import하는지에 대한 차이가 있다.</p>\n<p>개발모드에서는 큰 차이가 없지만 프로덕션 모드에서는 웹팩을 통해 명시적이지 않은 import를 방지할 수 있다.</p>\n<h3 id=\"finding-opportunities-to-shake-a-tree\" style=\"position:relative;\"><a href=\"#finding-opportunities-to-shake-a-tree\" aria-label=\"finding opportunities to shake a tree permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Finding opportunities to shake a tree</h3>\n<p>babel-preset-env를 사용한다면, es6 모듈을 건들지 않도록 해야한다.\nwebpack에서 tree shaking은 CommonJS모듈에 적용하기 더 어렵다고 한다.</p>\n<h3 id=\"keeping-side-effects-in-mind\" style=\"position:relative;\"><a href=\"#keeping-side-effects-in-mind\" aria-label=\"keeping side effects in mind permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>keeping side effects in mind</h3>\n<p>사이드 이펙트가 없어야 예측가능한 입력에 대하여 예측가능한 결과를 반환할 것이기 대문에 tree shaking 가능하다.</p>\n<p>webpack config의 module.rules나 package.json 의 sideEffects에 명시적으로 (특정 파일 또는 전체에)sideEffects가 있음을 알려줄 수 있다.</p>\n<h3 id=\"importing-only-what-we-need\" style=\"position:relative;\"><a href=\"#importing-only-what-we-need\" aria-label=\"importing only what we need permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Importing only what we need</h3>\n<p>array-utils의 simpleSort 만 import할 때와 utils 전체를 가져오고 utils.simpleSort를 호출할 때의 차이를 보자</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 626px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABp0lEQVQoz6WR33KaUBDGeYe2mUyqpY0oAh7kvwFROBxEDFC1ThvlMp1O+gaaztT0QhOgMTc25nHbJZ0+Qc/85ju73+45F7tUXXT+gRnR45UhJ/sNifCKz6u+qIeQMsgB2DbmJNLFMxKmSA9YCVOqHZM4dUcLh4RBgMfRpI8jw3bDQWras25vajsxPl+QKLW8D9H4Mpl8dvEF0oeCNqCO32nwjWzFgtQxdCSpKtOyWAHxqF+pmS9psVpXZSuSrfOm7LWMoMqaL6rtI1o+ohVqm++3xa/tT+BxUzyC3t6XCs5tGR9AN2XPHvy73eHu/pA9PGW7A0D9/o9Drdb5ap2BLkuK5zRf3RTLdXZ9k1+Xcdmw/J59+1Gam2KfPzytNztIqeOaRjetSuOswqh0XWkh55Q9O6nJnOC9bdhN3jtlodp5w5qvmQ6HiN5JNCM5qRmvaJlSu3Hy8XJ88TVJRumsN30fun7sD3rJaG5YU9Hwzf5wMr+aLq5gKeNPX9xwDgMWNL+cNiwQLtEIkU6QhpFGeC0QVCyoPqcQWCYMGRkBPGg902i7f03gD+s/ysw6ZXQtAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"utils.simpleSort_vs_simpleSort\"\n        title=\"utils.simpleSort_vs_simpleSort\"\n        src=\"/static/23e740fcac7ca05d34f5d4a244d3d69d/af590/utils.simpleSort_vs_simpleSort.png\"\n        srcset=\"/static/23e740fcac7ca05d34f5d4a244d3d69d/5a46d/utils.simpleSort_vs_simpleSort.png 300w,\n/static/23e740fcac7ca05d34f5d4a244d3d69d/0a47e/utils.simpleSort_vs_simpleSort.png 600w,\n/static/23e740fcac7ca05d34f5d4a244d3d69d/af590/utils.simpleSort_vs_simpleSort.png 626w\"\n        sizes=\"(max-width: 626px) 100vw, 626px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>사용되지 않는 utils들을 tree shaking 함으로써 스크립트의 다운시간과, 처리시간을 줄일 수 있음을 확인할 수 있다.</p>\n<h3 id=\"when-things-arent-so-straightforward\" style=\"position:relative;\"><a href=\"#when-things-arent-so-straightforward\" aria-label=\"when things arent so straightforward permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>When things aren’t so straightforward</h3>\n<p>tree shaking의 효과가 없는 경우 CommonJS패턴인지 확인해봐라\nCommonJS 패턴을 다루기 위한 플러그인들이 존재하지만 일부의 CommonJS 패턴에만 가능할 것이다. 안정적으로 tree shaking을 하려면 ES6 모듈을 사용해라</p>\n<p>출처:\n<a href=\"https://developers.google.com/web/fundamentals/performance/optimizing-javascript/tree-shaking\">https://developers.google.com/web/fundamentals/performance/optimizing-javascript/tree-shaking</a></p>\n<p><a href=\"https://webpack.js.org/guides/tree-shaking/\">https://webpack.js.org/guides/tree-shaking/</a></p>","frontmatter":{"title":"[Performance] Optimizing_javascript - (1)","date":"February 14, 2021"}}},"pageContext":{"slug":"/Web-Performance/optimizing_javascript-1/","previous":{"fields":{"slug":"/Web-Performance/rendering_path-2/"},"frontmatter":{"title":"[Performance] 렌더링 경로 - (2)","category":"Web-Performance","draft":false}},"next":null}}}